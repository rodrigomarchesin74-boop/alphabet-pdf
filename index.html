<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALPHAbet - Gerador de Documentos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        header h1 { font-size: 2em; margin-bottom: 10px; }
        header p { font-size: 0.9em; opacity: 0.95; }
        .content { padding: 30px; }
        .section { margin-bottom: 30px; padding: 20px; background: #f8f9fa; border-left: 4px solid #667eea; border-radius: 5px; }
        .section h2 { color: #667eea; margin-bottom: 15px; }
        .subsection { margin-bottom: 20px; padding: 15px; background: white; border-radius: 5px; border-left: 3px solid #ddd; }
        .subsection h3 { color: #555; font-size: 0.95em; margin-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #333; }
        input[type="text"], input[type="date"], textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial; font-size: 1em; }
        textarea { resize: none; height: 100px; }
        input[type="checkbox"] { margin-right: 8px; cursor: pointer; }
        .checkbox-group { display: flex; align-items: center; margin-bottom: 10px; }
        .checkbox-group label { margin-bottom: 0; cursor: pointer; color: #333; }
        .checkbox-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .checkbox-item { display: flex; align-items: center; }
        .checkbox-item input[type="checkbox"] { margin-right: 8px; }
        .checkbox-item label { margin-bottom: 0; cursor: pointer; color: #333; }
        .button-group { display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap; }
        .button-group-right { display: flex; gap: 10px; justify-content: flex-end; align-items: center; margin-top: 20px; }
        button { padding: 12px 25px; border: none; border-radius: 5px; font-size: 1em; cursor: pointer; transition: all 0.3s; }
        .btn-primary { background: #667eea; color: white; }
        .btn-primary:hover { background: #5568d3; }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; }
        .message { padding: 15px; border-radius: 5px; margin-bottom: 20px; display: none; }
        .message.show { display: block; }
        .message.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .message.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .inline-message { padding: 8px 15px; border-radius: 5px; font-size: 0.9em; opacity: 0; transition: opacity 0.3s; }
        .inline-message.show { opacity: 1; }
        .inline-message.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .inline-message.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .tabs { display: flex; border-bottom: 2px solid #ddd; margin-bottom: 20px; }
        .tab-button { padding: 10px 20px; background: none; border: none; cursor: pointer; font-size: 1em; border-bottom: 3px solid transparent; }
        .tab-button.active { color: #667eea; border-bottom-color: #667eea; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö ALPHAbet</h1>
            <p>Gerador de Programa de Estudo AD/DP</p>
        </header>
        <div class="content">
            <div id="message" class="message"></div>
            <div class="tabs">
                <button class="tab-button active" onclick="switchTab(event, 'datas')">Configura√ß√µes</button>
                <button class="tab-button" onclick="switchTab(event, 'form')">Formul√°rio</button>
            </div>
            
            <div id="datas" class="tab-content active">
                <div class="section">
                    <h2>‚öôÔ∏è Configura√ß√µes</h2>
                    
                    <div class="subsection">
                        <h3>Per√≠odos de Avalia√ß√£o</h3>
                        <div class="grid-2">
                            <div class="form-group"><label for="NP1_inicio">NP1 - In√≠cio</label><input type="date" id="NP1_inicio"></div>
                            <div class="form-group"><label for="NP1_fim">NP1 - Fim</label><input type="date" id="NP1_fim"></div>
                            <div class="form-group"><label for="NP2_inicio">NP2 - In√≠cio</label><input type="date" id="NP2_inicio"></div>
                            <div class="form-group"><label for="NP2_fim">NP2 - Fim</label><input type="date" id="NP2_fim"></div>
                            <div class="form-group"><label for="SUB_inicio">SUB - In√≠cio</label><input type="date" id="SUB_inicio"></div>
                            <div class="form-group"><label for="SUB_fim">SUB - Fim</label><input type="date" id="SUB_fim"></div>
                            <div class="form-group"><label for="EXAME_inicio">EXAME - In√≠cio</label><input type="date" id="EXAME_inicio"></div>
                            <div class="form-group"><label for="EXAME_fim">EXAME - Fim</label><input type="date" id="EXAME_fim"></div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Prazos Especiais - Grade/RD</h3>
                        <div class="grid-2">
                            <div class="form-group"><label for="AC_prazo_grade">AC</label><input type="date" id="AC_prazo_grade"></div>
                            <div class="form-group"><label for="AEX_prazo_grade">AEX</label><input type="date" id="AEX_prazo_grade"></div>
                            <div class="form-group"><label for="ED_prazo_grade">ED</label><input type="date" id="ED_prazo_grade"></div>
                            <div class="form-group"><label for="PIM_prazo_grade">PIM</label><input type="date" id="PIM_prazo_grade"></div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Prazos Especiais - Tutelados</h3>
                        <div class="grid-2">
                            <div class="form-group"><label for="AC_prazo_tutelado">AC</label><input type="date" id="AC_prazo_tutelado"></div>
                            <div class="form-group"><label for="AEX_prazo_tutelado">AEX</label><input type="date" id="AEX_prazo_tutelado"></div>
                            <div class="form-group"><label for="ED_prazo_tutelado">ED</label><input type="date" id="ED_prazo_tutelado"></div>
                            <div class="form-group"><label for="PIM_prazo_tutelado">PIM</label><input type="date" id="PIM_prazo_tutelado"></div>
                            <div class="form-group"><label for="AVA_prazo_tutelado">Disciplinas AVA</label><input type="date" id="AVA_prazo_tutelado"></div>
                            <div class="form-group"><label for="ONLINE_prazo_tutelado">Disciplinas On-line</label><input type="date" id="ONLINE_prazo_tutelado"></div>
                            <div class="form-group"><label for="ONLINE_ESP_prazo_tutelado">Disciplinas On-line Especiais</label><input type="date" id="ONLINE_ESP_prazo_tutelado"></div>
                            <div class="form-group"><label for="OPTATIVA_prazo_tutelado">Optativa</label><input type="date" id="OPTATIVA_prazo_tutelado"></div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Informa√ß√µes de Atendimento</h3>
                        <div class="form-group"><label for="atendimento_info">Info de Atendimento</label><input type="text" id="atendimento_info" placeholder="Ex: quintas-feiras, das 18h30 √†s 21h00"></div>
                        <div class="form-group"><label for="email_pim">E-mail para envio de PIM</label><input type="text" id="email_pim" placeholder="Ex: rodrigo.oliveira@docente.unip.br"></div>
                    </div>
                    
                    <div class="button-group-right">
                        <div id="config-message" class="inline-message"></div>
                        <button class="btn-primary" onclick="saveDates()">üíæ Salvar</button>
                        <button class="btn-secondary" onclick="resetDates()">üîÑ Padr√£o</button>
                    </div>
                </div>
            </div>
            
            <div id="form" class="tab-content">
                <div class="section">
                    <h2>üìã Dados do Aluno</h2>
                    <div class="form-group">
                        <label for="student_name">Nome do Aluno</label>
                        <input type="text" id="student_name" placeholder="Digite o nome completo">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="regime_grade">
                        <label for="regime_grade">Aluno participante do regime de grade ou RD</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="has_subsequent_semester">
                        <label for="has_subsequent_semester">Possui disciplinas em semestres subsequentes</label>
                    </div>
                </div>
                
                <div class="section">
                    <h2>üìö Disciplinas</h2>
                    
                    <div class="subsection">
                        <h3>Atividades Gerais</h3>
                        <div class="checkbox-group">
                            <input type="checkbox" id="task_AC">
                            <label for="task_AC">Atividades Complementares (AC)</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="task_EXT">
                            <label for="task_EXT">Atividades de Extens√£o (AEX)</label>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Disciplina(s) AVA</h3>
                        <div class="checkbox-group">
                            <input type="checkbox" id="task_AVA" onchange="toggleAVADisplay()">
                            <label for="task_AVA">Disciplina(s) AVA</label>
                        </div>
                        <div id="ava-input" style="display: none;">
                            <div class="form-group">
                                <textarea id="AVA_disciplines" placeholder="Digite as disciplinas AVA (uma por linha)"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Disciplina(s) On-line</h3>
                        <div class="checkbox-group">
                            <input type="checkbox" id="task_ONLINE" onchange="toggleONLINEDisplay()">
                            <label for="task_ONLINE">Disciplina(s) On-line</label>
                        </div>
                        <div id="online-input" style="display: none;">
                            <div class="form-group">
                                <textarea id="ONLINE_disciplines" placeholder="Digite as disciplinas On-line (uma por linha)"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Disciplina(s) On-line - Casos Especiais</h3>
                        <div class="checkbox-group">
                            <input type="checkbox" id="task_ONLINE_ESPECIAL" onchange="toggleONLINE_ESPECIALDisplay()">
                            <label for="task_ONLINE_ESPECIAL">Disciplina(s) On-line - Casos Especiais</label>
                        </div>
                        <div id="online-especial-input" style="display: none;">
                            <div class="form-group">
                                <textarea id="ONLINE_ESPECIAL_disciplines" placeholder="Digite as disciplinas On-line - Casos Especiais (uma por linha)"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Disciplina Optativa</h3>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" id="optativa_idosa" onchange="updateOPTATIVA()">
                                <label for="optativa_idosa">Atua√ß√£o Junto a Pessoa Idosa</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="optativa_marketing" onchange="updateOPTATIVA()">
                                <label for="optativa_marketing">Marketing Pessoal</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Estudos Disciplinares (ED)</h3>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" id="ed_i" onchange="updateED()">
                                <label for="ed_i">ED I</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="ed_ii" onchange="updateED()">
                                <label for="ed_ii">ED II</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="ed_iii" onchange="updateED()">
                                <label for="ed_iii">ED III</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="ed_iv" onchange="updateED()">
                                <label for="ed_iv">ED IV</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Projeto Integrado Multidisciplinar (PIM)</h3>
                        <div class="checkbox-grid">
                            <div class="checkbox-item">
                                <input type="checkbox" id="pim_i" onchange="updatePIM()">
                                <label for="pim_i">PIM I</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="pim_ii" onchange="updatePIM()">
                                <label for="pim_ii">PIM II</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="pim_iii" onchange="updatePIM()">
                                <label for="pim_iii">PIM III</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="pim_iv" onchange="updatePIM()">
                                <label for="pim_iv">PIM IV</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="button-group-right">
                    <button class="btn-primary" onclick="generatePDF()">üìÑ Gerar PDF</button>
                    <button class="btn-secondary" onclick="resetForm()">üîÑ Limpar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DEFAULT_DATES = {
            NP1_inicio: "2025-09-15", NP1_fim: "2025-09-27",
            NP2_inicio: "2025-11-03", NP2_fim: "2025-11-14",
            SUB_inicio: "2025-11-17", SUB_fim: "2025-11-25",
            EXAME_inicio: "2025-12-04", EXAME_fim: "2025-12-12",
            AC_prazo_grade: "2025-10-20", AEX_prazo_grade: "2025-10-20",
            ED_prazo_grade: "2025-10-20", PIM_prazo_grade: "2025-10-30",
            AC_prazo_tutelado: "2025-10-20", AEX_prazo_tutelado: "2025-10-20",
            ED_prazo_tutelado: "2025-10-20", PIM_prazo_tutelado: "2025-10-30",
            AVA_prazo_tutelado: "2025-10-20", ONLINE_prazo_tutelado: "2025-10-20",
            ONLINE_ESP_prazo_tutelado: "2025-10-20", OPTATIVA_prazo_tutelado: "2025-10-20",
            atendimento_info: "quintas-feiras, das 18h30 √†s 21h00",
            email_pim: "rodrigo.oliveira@docente.unip.br"
        };
        
        function toggleAVADisplay() {
            const checkbox = document.getElementById('task_AVA');
            const display = document.getElementById('ava-input');
            display.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function toggleONLINEDisplay() {
            const checkbox = document.getElementById('task_ONLINE');
            const display = document.getElementById('online-input');
            display.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function toggleONLINE_ESPECIALDisplay() {
            const checkbox = document.getElementById('task_ONLINE_ESPECIAL');
            const display = document.getElementById('online-especial-input');
            display.style.display = checkbox.checked ? 'block' : 'none';
        }
        
        function updateOPTATIVA() {
            const hasSelected = document.getElementById('optativa_idosa').checked || document.getElementById('optativa_marketing').checked;
            // Auto-marca√ß√£o impl√≠cita atrav√©s dos checkboxes individuais
        }
        
        function updateED() {
            // Auto-marca√ß√£o impl√≠cita atrav√©s dos checkboxes individuais
        }
        
        function updatePIM() {
            // Auto-marca√ß√£o impl√≠cita atrav√©s dos checkboxes individuais
        }
        
        window.addEventListener('load', function() {
            loadDates();
        });
        
        function switchTab(e, tabName) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(el => el.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            e.target.classList.add('active');
        }
        
        function loadDates() {
            const saved = localStorage.getItem('alphabetDates');
            const dates = saved ? JSON.parse(saved) : DEFAULT_DATES;
            Object.keys(dates).forEach(key => {
                const elem = document.getElementById(key);
                if (elem) elem.value = dates[key];
            });
        }
        
        function saveDates() {
            const dates = {};
            Object.keys(DEFAULT_DATES).forEach(key => {
                const elem = document.getElementById(key);
                if (elem) dates[key] = elem.value;
            });
            localStorage.setItem('alphabetDates', JSON.stringify(dates));
            showMessage('‚úÖ Configura√ß√£o salva!', 'success');
        }
        
        function resetDates() {
            if (confirm('Restaurar configura√ß√µes padr√£o?')) {
                Object.keys(DEFAULT_DATES).forEach(key => {
                    const elem = document.getElementById(key);
                    if (elem) elem.value = DEFAULT_DATES[key];
                });
                localStorage.removeItem('alphabetDates');
                showMessage('‚úÖ Padr√µes restaurados!', 'success');
            }
        }
        
        function formatDate(dateStr) {
            if (!dateStr) return '';
            const date = new Date(dateStr + 'T00:00:00');
            return date.toLocaleDateString('pt-BR');
        }
        
        function resetForm() {
            document.getElementById('student_name').value = '';
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.querySelectorAll('textarea').forEach(ta => ta.value = '');
            document.getElementById('ava-input').style.display = 'none';
            document.getElementById('online-input').style.display = 'none';
            document.getElementById('online-especial-input').style.display = 'none';
        }
        
        function showMessage(text, type) {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = `message ${type} show`;
            setTimeout(() => msg.classList.remove('show'), 5000);
        }
        
        function showInlineMessage(text, type) {
            const msg = document.getElementById('config-message');
            msg.textContent = text;
            msg.className = `inline-message ${type} show`;
            setTimeout(() => msg.classList.remove('show'), 3000);
        }
        
        function saveDates() {
            const dates = {};
            Object.keys(DEFAULT_DATES).forEach(key => {
                const elem = document.getElementById(key);
                if (elem) dates[key] = elem.value;
            });
            localStorage.setItem('alphabetDates', JSON.stringify(dates));
            showInlineMessage('‚úÖ Configura√ß√£o salva!', 'success');
        }
        
        function resetDates() {
            if (confirm('Restaurar configura√ß√µes padr√£o?')) {
                Object.keys(DEFAULT_DATES).forEach(key => {
                    const elem = document.getElementById(key);
                    if (elem) elem.value = DEFAULT_DATES[key];
                });
                localStorage.removeItem('alphabetDates');
                showInlineMessage('‚úÖ Padr√µes restaurados!', 'success');
            }
        }
        
        function generatePDF() {
            const studentName = document.getElementById('student_name').value.trim();
            if (!studentName) {
                showMessage('Por favor, insira o nome do aluno!', 'error');
                return;
            }
            
            const selectedTasks = [];
            if (document.getElementById('task_AC').checked) selectedTasks.push('AC');
            if (document.getElementById('task_EXT').checked) selectedTasks.push('EXT');
            if (document.getElementById('task_AVA').checked && document.getElementById('AVA_disciplines').value.trim()) selectedTasks.push('AVA');
            if (document.getElementById('task_ONLINE').checked && document.getElementById('ONLINE_disciplines').value.trim()) selectedTasks.push('ONLINE');
            if (document.getElementById('task_ONLINE_ESPECIAL').checked && document.getElementById('ONLINE_ESPECIAL_disciplines').value.trim()) selectedTasks.push('ONLINE_ESPECIAL');
            if (document.getElementById('optativa_idosa').checked || document.getElementById('optativa_marketing').checked) selectedTasks.push('OPTATIVA');
            if (document.getElementById('ed_i').checked || document.getElementById('ed_ii').checked || document.getElementById('ed_iii').checked || document.getElementById('ed_iv').checked) selectedTasks.push('ED');
            if (document.getElementById('pim_i').checked || document.getElementById('pim_ii').checked || document.getElementById('pim_iii').checked || document.getElementById('pim_iv').checked) selectedTasks.push('PIM');
            
            if (selectedTasks.length === 0) {
                showMessage('Selecione pelo menos uma tarefa ou disciplina!', 'error');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                const pageWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();
                const margin = 15;
                let yPos = 15;
                let pageNum = 1;
                const lineHeight = 5.25;
                
                const dates = JSON.parse(localStorage.getItem('alphabetDates')) || DEFAULT_DATES;
                const regimeGrade = document.getElementById('regime_grade').checked;
                const hasSubsequent = document.getElementById('has_subsequent_semester').checked;
                
                doc.setFont('Helvetica', 'bold');
                doc.setFontSize(14);
                doc.text('Regime de Adapta√ß√£o/Depend√™ncia - AD/DP', pageWidth / 2, yPos, { align: 'center' });
                yPos += lineHeight;
                doc.setFontSize(12);
                doc.text('Programa de Estudo', pageWidth / 2, yPos, { align: 'center' });
                yPos += lineHeight * 2.5;
                
                doc.setFontSize(11);
                doc.setFont('Helvetica', 'bold');
                const labelWidth1 = doc.getTextWidth('Aluno/RA/Curso/Grade: ');
                doc.text('Aluno/RA/Curso/Grade: ', margin, yPos);
                doc.setFont('Helvetica', 'normal');
                doc.text(studentName, margin + labelWidth1, yPos);
                yPos += lineHeight;
                doc.setFont('Helvetica', 'bold');
                const labelWidth2 = doc.getTextWidth('Aluno participante do regime de grade? ');
                doc.text('Aluno participante do regime de grade? ', margin, yPos);
                doc.setFont('Helvetica', 'normal');
                doc.text((regimeGrade ? 'Sim' : 'N√£o'), margin + labelWidth2, yPos);
                yPos += lineHeight;
                doc.setFont('Helvetica', 'bold');
                const labelWidth3 = doc.getTextWidth('Possui disciplinas em semestres subsequentes? ');
                doc.text('Possui disciplinas em semestres subsequentes? ', margin, yPos);
                doc.setFont('Helvetica', 'normal');
                doc.text((hasSubsequent ? 'Sim' : 'N√£o'), margin + labelWidth3, yPos);
                yPos += lineHeight * 1.5;
                
                doc.setFont('Helvetica', 'normal');
                doc.setFontSize(10);
                doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                
                if (hasSubsequent) {
                    doc.setFont('Helvetica', 'italic');
                    doc.setFontSize(10);
                    const noteText = 'ATEN√á√ÉO!! Em conformidade √†s Diretrizes Curriculares da UNIP, voc√™ ter√° disciplinas em AD/DP para cumprir neste e no(s) pr√≥ximo(s) semestre(s). As indica√ß√µes a seguir correspondem ao conte√∫do a ser integralizado NESTE SEMESTRE. Para o(s) pr√≥ximo(s), voc√™ dever√° entrar em contato com a Coordena√ß√£o, para receber novas instru√ß√µes.';
                    const lines = doc.splitTextToSize(noteText, pageWidth - 30);
                    lines.forEach(line => {
                        if (yPos > pageHeight - 30) {
                            doc.addPage();
                            doc.setFont('Helvetica', 'italic');
                            doc.setFontSize(10);
                            yPos = 15;
                            pageNum++;
                            doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                        }
                        doc.text(line, margin, yPos);
                        yPos += lineHeight;
                    });
                    yPos += lineHeight;
                }
                
                selectedTasks.forEach(task => {
                    if (yPos > pageHeight - 30) {
                        doc.addPage();
                        yPos = 15;
                        pageNum++;
                        doc.setFont('Helvetica', 'normal');
                        doc.setFontSize(10);
                        doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                    }
                    
                    const taskNames = {
                        'AC': 'Atividades Complementares (AC)',
                        'EXT': 'Atividades de Extens√£o (AEX)',
                        'AVA': 'Disciplina(s) AVA',
                        'ONLINE': 'Disciplina(s) On-line',
                        'ONLINE_ESPECIAL': 'Disciplina(s) On-line - Casos Especiais',
                        'OPTATIVA': 'Disciplina Optativa',
                        'ED': 'Estudos Disciplinares (ED)',
                        'PIM': 'Projeto Integrado Multidisciplinar (PIM)'
                    };
                    
                    doc.setFont('Helvetica', 'bold');
                    doc.setFontSize(11);
                    doc.text(taskNames[task] || task, margin, yPos);
                    yPos += lineHeight;
                    
                    doc.setFont('Helvetica', 'normal');
                    doc.setFontSize(10);
                    
                    let details = [];
                    
                    if (task === 'AC') {
                        details = [
                            'Carga hor√°ria exigida: 100 horas.',
                            'A entrega das AC √© feita on-line, exclusivamente via √Årea do Aluno/AC.'
                        ];
                        if (regimeGrade) {
                            details.push('Prazo: ' + formatDate(dates.AC_prazo_grade) + '.');
                        } else {
                            details.push('Prazo: ' + formatDate(dates.AC_prazo_tutelado) + '.');
                        }
                    } else if (task === 'EXT') {
                        details = [
                            'Carga hor√°ria exigida: 210 horas.',
                            'A entrega das Atividades de Extens√£o √© feita on-line, exclusivamente via √Årea do Aluno/AEX.'
                        ];
                        if (regimeGrade) {
                            details.push('Prazo: ' + formatDate(dates.AEX_prazo_grade) + '.');
                        } else {
                            details.push('Prazo: ' + formatDate(dates.AEX_prazo_tutelado) + '.');
                        }
                    } else if (task === 'AVA') {
                        const disciplines = document.getElementById('AVA_disciplines').value.split('\n').filter(d => d.trim());
                        if (disciplines.length > 0) details.push('Disciplina(s): ' + disciplines.join(', ') + '.');
                        details.push('Acessar √Årea do Aluno/AVA/Conte√∫dos Acad√™micos/Minhas Disciplinas.');
                        details.push('Para NP1, responder, salvar e ENVIAR TODOS os question√°rios de TODAS as unidades.');
                        if (regimeGrade) {
                            details.push('Para NP2, SUB e EXAME, agendar as provas de cada disciplina no sistema e realiz√°-las PRESENCIALMENTE no Laborat√≥rio de Inform√°tica.');
                            details.push('O aluno dever√° realizar o EXAME apenas se a M√©dia Semestral (MS) for inferior a 7,0 (sete).');
                            details.push({ text: 'NP1: de ' + formatDate(dates.NP1_inicio) + ' a ' + formatDate(dates.NP1_fim) + '.', color: [0, 0, 255] });
                            details.push({ text: 'NP2: de ' + formatDate(dates.NP2_inicio) + ' a ' + formatDate(dates.NP2_fim) + '.', color: [0, 128, 0] });
                            details.push({ text: 'SUB: de ' + formatDate(dates.SUB_inicio) + ' a ' + formatDate(dates.SUB_fim) + '.', color: [255, 140, 0] });
                            details.push({ text: 'EXAME: de ' + formatDate(dates.EXAME_inicio) + ' a ' + formatDate(dates.EXAME_fim) + '.', color: [128, 0, 32] });
                        } else {
                            details.push('A nota dos exerc√≠cios realizados ser√° replicada para NP1 e NP2.');
                            details.push('Para fins de aprova√ß√£o, o aluno deve alcan√ßar uma m√©dia (nota) igual ou superior a 5,0 (cinco).');
                            details.push('Prazo: ' + formatDate(dates.AVA_prazo_tutelado) + '.');
                        }
                    } else if (task === 'ONLINE') {
                        const disciplines = document.getElementById('ONLINE_disciplines').value.split('\n').filter(d => d.trim());
                        if (disciplines.length > 0) details.push('Disciplina(s): ' + disciplines.join(', ') + '.');
                        if (regimeGrade) {
                            details.push('Aten√ß√£o √† plataforma de ACESSO para responder estas disciplinas, que √© DIFERENTE das disciplinas AVA.');
                            details.push('Acessar √Årea do Aluno/Disciplinas On-line.');
                            details.push('Responder TODOS OS M√ìDULOS DE QUEST√ïES.');
                            details.push('O aluno dever√° realizar o EXAME apenas se a M√©dia Semestral (MS) for inferior a 7,0 (sete).');
                            details.push({ text: 'NP1: de ' + formatDate(dates.NP1_inicio) + ' a ' + formatDate(dates.NP1_fim) + '.', color: [0, 0, 255] });
                            details.push({ text: 'NP2: de ' + formatDate(dates.NP2_inicio) + ' a ' + formatDate(dates.NP2_fim) + '.', color: [0, 128, 0] });
                            details.push({ text: 'SUB: de ' + formatDate(dates.SUB_inicio) + ' a ' + formatDate(dates.SUB_fim) + '.', color: [255, 140, 0] });
                            details.push({ text: 'EXAME: de ' + formatDate(dates.EXAME_inicio) + ' a ' + formatDate(dates.EXAME_fim) + '.', color: [128, 0, 32] });
                        } else {
                            details.push('Aten√ß√£o √† plataforma de ACESSO para responder estas disciplinas.');
                            details.push('Acessar √Årea do Aluno/Disciplinas On-line.');
                            details.push('Responder TODOS OS M√ìDULOS DE QUEST√ïES.');
                            details.push('Prazo: ' + formatDate(dates.ONLINE_prazo_tutelado) + '.');
                        }
                    } else if (task === 'ONLINE_ESPECIAL') {
                        const disciplines = document.getElementById('ONLINE_ESPECIAL_disciplines').value.split('\n').filter(d => d.trim());
                        if (disciplines.length > 0) details.push('Disciplina(s): ' + disciplines.join(', ') + '.');
                        details.push('Acessar √Årea do Aluno/AVA/Conte√∫dos Acad√™micos/Minhas Disciplinas.');
                        details.push('Responder, salvar e ENVIAR TODOS os question√°rios de TODAS as unidades.');
                        details.push('A nota dos exerc√≠cios realizados ser√° replicada para NP1 e NP2.');
                        if (regimeGrade) {
                            details.push('O aluno dever√° realizar o EXAME apenas se a M√©dia Semestral (MS) for inferior a 7,0 (sete).');
                            details.push({ text: 'NP1: de ' + formatDate(dates.NP1_inicio) + ' a ' + formatDate(dates.NP1_fim) + '.', color: [0, 0, 255] });
                            details.push({ text: 'NP2: de ' + formatDate(dates.NP2_inicio) + ' a ' + formatDate(dates.NP2_fim) + '.', color: [0, 128, 0] });
                            details.push({ text: 'SUB: de ' + formatDate(dates.SUB_inicio) + ' a ' + formatDate(dates.SUB_fim) + '.', color: [255, 140, 0] });
                            details.push({ text: 'EXAME: de ' + formatDate(dates.EXAME_inicio) + ' a ' + formatDate(dates.EXAME_fim) + '.', color: [128, 0, 32] });
                        } else {
                            details.push('Prazo: ' + formatDate(dates.ONLINE_ESP_prazo_tutelado) + '.');
                        }
                    } else if (task === 'OPTATIVA') {
                        const optativas = [];
                        if (document.getElementById('optativa_idosa').checked) optativas.push('Atua√ß√£o Junto √† Pessoa Idosa');
                        if (document.getElementById('optativa_marketing').checked) optativas.push('Marketing Pessoal');
                        if (optativas.length > 0) details.push('Disciplina(s): ' + optativas.join(', ') + '.');
                        details.push('Acessar √Årea do Aluno/AVA/Conte√∫dos Acad√™micos/Minhas Disciplinas.');
                        details.push('Para NP1, responder, salvar e ENVIAR TODOS os question√°rios de TODAS as unidades.');
                        if (regimeGrade) {
                            details.push('O aluno dever√° realizar o EXAME apenas se a M√©dia Semestral (MS) for inferior a 7,0 (sete).');
                            details.push({ text: 'NP1: de ' + formatDate(dates.NP1_inicio) + ' a ' + formatDate(dates.NP1_fim) + '.', color: [0, 0, 255] });
                            details.push({ text: 'NP2: de ' + formatDate(dates.NP2_inicio) + ' a ' + formatDate(dates.NP2_fim) + '.', color: [0, 128, 0] });
                            details.push({ text: 'SUB: de ' + formatDate(dates.SUB_inicio) + ' a ' + formatDate(dates.SUB_fim) + '.', color: [255, 140, 0] });
                            details.push({ text: 'EXAME: de ' + formatDate(dates.EXAME_inicio) + ' a ' + formatDate(dates.EXAME_fim) + '.', color: [128, 0, 32] });
                        } else {
                            details.push('Prazo: ' + formatDate(dates.OPTATIVA_prazo_tutelado) + '.');
                        }
                    } else if (task === 'ED') {
                        const eds = [];
                        if (document.getElementById('ed_i').checked) eds.push('ED I');
                        if (document.getElementById('ed_ii').checked) eds.push('ED II');
                        if (document.getElementById('ed_iii').checked) eds.push('ED III');
                        if (document.getElementById('ed_iv').checked) eds.push('ED IV');
                        if (eds.length > 0) details.push('Disciplina(s): ' + eds.join(', ') + '.');
                        details.push('Responder TODAS as quest√µes (35) de cada m√≥dulo que estiver em AD/DP.');
                        details.push('Acertar, para fins de aprova√ß√£o, pelo menos 10 quest√µes para cada m√≥dulo que estiver em AD/DP.');
                        if (regimeGrade) {
                            details.push('Prazo: ' + formatDate(dates.ED_prazo_grade) + '.');
                        } else {
                            details.push('Prazo: ' + formatDate(dates.ED_prazo_tutelado) + '.');
                        }
                    } else if (task === 'PIM') {
                        const pims = [];
                        if (document.getElementById('pim_i').checked) pims.push('PIM I');
                        if (document.getElementById('pim_ii').checked) pims.push('PIM II');
                        if (document.getElementById('pim_iii').checked) pims.push('PIM III');
                        if (document.getElementById('pim_iv').checked) pims.push('PIM IV');
                        if (pims.length > 0) details.push('Disciplina(s): ' + pims.join(', ') + '.');
                        details.push('Elaborar o trabalho, conforme o Manual anexo.');
                        details.push('O trabalho deve ser DIGITADO conforme as normas da ABNT.');
                        details.push('Ap√≥s o t√©rmino da reda√ß√£o, CONVERTER o(s) arquivo(s) para o formato PDF.');
                        details.push('Enviar o conte√∫do elaborado para: ' + dates.email_pim);
                        if (regimeGrade) {
                            details.push('Prazo: ' + formatDate(dates.PIM_prazo_grade) + '.');
                        } else {
                            details.push('Prazo: ' + formatDate(dates.PIM_prazo_tutelado) + '.');
                        }
                    }
                    
                    details.forEach(detail => {
                        if (typeof detail === 'string' && detail.trim()) {
                            const lines = doc.splitTextToSize('‚Ä¢ ' + detail.trim(), pageWidth - 30);
                            lines.forEach(line => {
                                if (yPos > pageHeight - 15) {
                                    doc.addPage();
                                    doc.setFont('Helvetica', 'normal');
                                    doc.setFontSize(10);
                                    yPos = 15;
                                    pageNum++;
                                    doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                                }
                                doc.setTextColor(0, 0, 0);
                                doc.text(line, margin, yPos);
                                yPos += lineHeight;
                            });
                        } else if (typeof detail === 'object' && detail.text) {
                            // Detalhe com cor especial
                            const lines = doc.splitTextToSize('‚Ä¢ ' + detail.text, pageWidth - 30);
                            lines.forEach((line, idx) => {
                                if (yPos > pageHeight - 15) {
                                    doc.addPage();
                                    doc.setFont('Helvetica', 'normal');
                                    doc.setFontSize(10);
                                    yPos = 15;
                                    pageNum++;
                                    doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                                }
                                if (idx === 0 && detail.color) {
                                    // Primeira linha: aplicar cor no r√≥tulo e nas datas
                                    const parts = line.split(':');
                                    if (parts.length > 1) {
                                        // Parte antes dos dois pontos (label) - COM COR
                                        doc.setTextColor(detail.color[0], detail.color[1], detail.color[2]);
                                        doc.text(parts[0] + ':', margin, yPos);
                                        // Parte depois dos dois pontos (data com mesma cor)
                                        doc.setTextColor(detail.color[0], detail.color[1], detail.color[2]);
                                        doc.text(parts.slice(1).join(':'), margin + doc.getTextWidth(parts[0] + ':'), yPos);
                                    } else {
                                        doc.setTextColor(detail.color[0], detail.color[1], detail.color[2]);
                                        doc.text(line, margin, yPos);
                                    }
                                } else {
                                    doc.setTextColor(0, 0, 0);
                                    doc.text(line, margin, yPos);
                                }
                                yPos += lineHeight;
                            });
                            doc.setTextColor(0, 0, 0);
                        }
                    });
                    yPos += lineHeight;
                });
                
                if (yPos > pageHeight - 20) {
                    doc.addPage();
                    yPos = 15;
                    pageNum++;
                    doc.setFont('Helvetica', 'normal');
                    doc.setFontSize(10);
                    doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                }
                
                doc.setFont('Helvetica', 'bold');
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                const attendText = 'Em caso de d√∫vidas, comparecer no ATENDIMENTO DA COORDENA√á√ÉO, ' + dates.atendimento_info + '.';
                const attendLines = doc.splitTextToSize(attendText, pageWidth - 30);
                attendLines.forEach(line => {
                    if (yPos > pageHeight - 15) {
                        doc.addPage();
                        yPos = 15;
                        pageNum++;
                        doc.setFont('Helvetica', 'normal');
                        doc.setFontSize(10);
                        doc.text('P√°gina ' + pageNum, pageWidth - 30, pageHeight - 10);
                    }
                    doc.text(line, margin, yPos);
                    yPos += lineHeight;
                });
                
                const cleanName = studentName.normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-zA-Z0-9]/g, '_');
                doc.save('DP_' + cleanName + '.pdf');
                showMessage('‚úÖ PDF gerado com sucesso!', 'success');
            } catch (error) {
                showMessage('‚ùå Erro: ' + error.message, 'error');
                console.error(error);
            }
        }
    </script>
</body>
</html>
